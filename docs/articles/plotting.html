<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting with quanteda • quanteda</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">quanteda</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/kbenoit/quanteda">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Plotting with quanteda</h1>
            
          </div>

    
    
<div class="contents">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(quanteda)</code></pre></div>
<p>At the moment, two quanteda objects, <code>dfm</code> and <code>kwic</code> have custom plot methods: <code>dfm</code> is plotted as a wordcloud, <code>kwic</code> as a lexical dispersion plot. There are also other plots of interest which can be made with the standard R techniques.</p>
<div id="wordcloud" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#wordcloud" class="anchor"> </a></body></html>1. Wordcloud</h1>
<p>Plotting a <code>dfm</code> object will create a wordcloud using the <code>wordcloud</code> pacakge.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a dfm from a somewhat smaller corpus</span>
inaugDfm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dfm.html">dfm</a></span>(data_corpus_inaugural[<span class="dv">0</span>:<span class="dv">10</span>], <span class="dt">remove =</span> <span class="kw"><a href="../reference/stopwords.html">stopwords</a></span>(<span class="st">'english'</span>), <span class="dt">removePunct =</span> <span class="ot">TRUE</span>)
<span class="co"># Some words will not fit on a plot this size, so suppress those warings</span>
<span class="kw"><a href="../reference/textplot_wordcloud.html">textplot_wordcloud</a></span>(<span class="kw"><a href="../reference/dfm_trim.html">dfm_trim</a></span>(inaugDfm, <span class="dt">min_count =</span> <span class="dv">10</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>))</code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<p>You can also plot a “comparison cloud”, but this can only be done with fewer than eight documents:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">compDfm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dfm.html">dfm</a></span>(<span class="kw"><a href="../reference/corpus_subset.html">corpus_subset</a></span>(data_corpus_inaugural, President %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">"Washington"</span>, <span class="st">"Jefferson"</span>, <span class="st">"Madison"</span>)),
               <span class="dt">groups =</span> <span class="st">"President"</span>, <span class="dt">remove =</span> <span class="kw"><a href="../reference/stopwords.html">stopwords</a></span>(<span class="st">"english"</span>), <span class="dt">removePunct =</span> <span class="ot">TRUE</span>)
<span class="kw"><a href="../reference/textplot_wordcloud.html">textplot_wordcloud</a></span>(<span class="kw"><a href="../reference/dfm_trim.html">dfm_trim</a></span>(compDfm, <span class="dt">min_count =</span> <span class="dv">5</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>), <span class="dt">comparison =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>Plot will pass through additional arguments to the underlying call to <code>wordcloud</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/textplot_wordcloud.html">textplot_wordcloud</a></span>(inaugDfm, <span class="dt">min.freq =</span> <span class="dv">10</span>,
     <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">'red'</span>, <span class="st">'pink'</span>, <span class="st">'green'</span>, <span class="st">'purple'</span>, <span class="st">'orange'</span>, <span class="st">'blue'</span>))</code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
</div>
<div id="lexical-dispersion-plot" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#lexical-dispersion-plot" class="anchor"> </a></body></html>2. Lexical dispersion plot</h1>
<p>Plotting a <code>kwic</code> object produces a lexical dispersion plot which allows us to visualize the occurrences of particular terms throughout the text. We call these “x-ray” plots due to their similarity to the data produced by <a href="https://en.wikipedia.org/wiki/X-Ray_(Amazon_Kindle)">Amazon’s “x-ray” feature for Kindle books</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/textplot_xray.html">textplot_xray</a></span>(<span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_corpus_inaugural[<span class="dv">40</span>:<span class="dv">57</span>], <span class="st">"american"</span>))</code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<p>You can also pass multiple kwic objects to <code>plot</code> to compare the dispersion of different terms:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/textplot_xray.html">textplot_xray</a></span>(
     <span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_corpus_inaugural[<span class="dv">40</span>:<span class="dv">57</span>], <span class="st">"american"</span>),
     <span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_corpus_inaugural[<span class="dv">40</span>:<span class="dv">57</span>], <span class="st">"people"</span>),
     <span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_corpus_inaugural[<span class="dv">40</span>:<span class="dv">57</span>], <span class="st">"communist"</span>)
)</code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p>If you’re only plotting a single document, but with multiple keywords, then the keywords are displayed one below the other rather than side-by-side.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mobydickCorpus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/corpus.html">corpus</a></span>(data_char_mobydick)

<span class="kw"><a href="../reference/textplot_xray.html">textplot_xray</a></span>(
    <span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_char_mobydick, <span class="st">"whale"</span>),
    <span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_char_mobydick, <span class="st">"ahab"</span>)
)</code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<p>You might also have noticed that the x-axis scale is the absolute token index for single texts and relative token index when multiple texts are being compared. If you prefer, you can specify that you want an absolute scale:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/textplot_xray.html">textplot_xray</a></span>(
     <span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_corpus_inaugural[<span class="dv">40</span>:<span class="dv">57</span>], <span class="st">"american"</span>),
     <span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_corpus_inaugural[<span class="dv">40</span>:<span class="dv">57</span>], <span class="st">"people"</span>),
     <span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_corpus_inaugural[<span class="dv">40</span>:<span class="dv">57</span>], <span class="st">"communist"</span>),
     <span class="dt">scale =</span> <span class="st">'absolute'</span>
)</code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>In this case, the texts may not have the same length, so the tokens that don’t exist in a particular text are shaded in grey.</p>
<div id="modifying-lexical-dispersion-plots" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#modifying-lexical-dispersion-plots" class="anchor"> </a></body></html>Modifying lexical dispersion plots</h2>
<p>The object returned is a ggplot object, which can be modified using ggplot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())
g &lt;-<span class="st"> </span><span class="kw"><a href="../reference/textplot_xray.html">textplot_xray</a></span>(
     <span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_corpus_inaugural[<span class="dv">40</span>:<span class="dv">57</span>], <span class="st">"american"</span>),
     <span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_corpus_inaugural[<span class="dv">40</span>:<span class="dv">57</span>], <span class="st">"people"</span>),
     <span class="kw"><a href="../reference/kwic.html">kwic</a></span>(data_corpus_inaugural[<span class="dv">40</span>:<span class="dv">57</span>], <span class="st">"communist"</span>)
)
g +<span class="st"> </span><span class="kw">aes</span>(<span class="dt">color =</span> keyword) +<span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">'blue'</span>, <span class="st">'red'</span>, <span class="st">'green'</span>))</code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
</div>
</div>
<div id="frequency-plots" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#frequency-plots" class="anchor"> </a></body></html>3. Frequency plots</h1>
<p>You can plot the frequency of the top features in a text using <code>topfeatures</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inaugFeatures &lt;-<span class="st"> </span><span class="kw"><a href="../reference/topfeatures.html">topfeatures</a></span>(inaugDfm, <span class="dv">100</span>)

<span class="co"># Create a data.frame for ggplot</span>
topDf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
    <span class="kw">list</span>(
        <span class="dt">term =</span> <span class="kw">names</span>(inaugFeatures),
        <span class="dt">frequency =</span> <span class="kw">unname</span>(inaugFeatures)
    )
)

<span class="co"># Sort by reverse frequency order</span>
topDf$term &lt;-<span class="st"> </span><span class="kw">with</span>(topDf, <span class="kw">reorder</span>(term, -frequency))

<span class="kw">ggplot</span>(topDf) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>term, <span class="dt">y=</span>frequency)) +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">hjust=</span><span class="dv">1</span>))</code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<p>If you wanted to compare the frequency of a single term across different texts, you could plot the dfm matrix like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">americanFreq &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">list</span>(
    <span class="dt">document =</span> <span class="kw">rownames</span>(inaugDfm[, <span class="st">'american'</span>]),
    <span class="dt">frequency =</span> <span class="kw">unname</span>(<span class="kw">as.matrix</span>(inaugDfm[, <span class="st">'american'</span>]))
))

<span class="kw">ggplot</span>(americanFreq) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>document,<span class="dt">y=</span>frequency)) +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">hjust=</span><span class="dv">1</span>))</code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
<p>The above plots are raw frequency plots. For relative frequency plots, (word count divided by the length of the chapter) we can weight the document-frequency matrix. To obtain expected word frequency per 100 words, we multiply by 100.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">relDfm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/weight.html">weight</a></span>(inaugDfm, <span class="dt">type=</span><span class="st">'relFreq'</span>) *<span class="st"> </span><span class="dv">100</span></code></pre></div>
<pre><code>## Warning: 'weight' is deprecated.
## Use 'dfm_weight' instead.
## See help("Deprecated")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(relDfm)</code></pre></div>
<pre><code>## Document-feature matrix of: 10 documents, 3,240 features (80.6% sparse).
## (showing first 6 documents and first 6 features)
##                  features
## docs              fellow-citizens     senate     house representatives
##   1789-Washington       0.1510574 0.15105740 0.3021148       0.3021148
##   1793-Washington       0.0000000 0.00000000 0.0000000       0.0000000
##   1797-Adams            0.2798507 0.09328358 0.0000000       0.1865672
##   1801-Jefferson        0.2424242 0.00000000 0.0000000       0.0000000
##   1805-Jefferson        0.0000000 0.00000000 0.0000000       0.0000000
##   1809-Madison          0.1879699 0.00000000 0.0000000       0.0000000
##                  features
## docs                  among vicissitudes
##   1789-Washington 0.1510574    0.1510574
##   1793-Washington 0.0000000    0.0000000
##   1797-Adams      0.3731343    0.0000000
##   1801-Jefferson  0.1212121    0.0000000
##   1805-Jefferson  0.6835938    0.0000000
##   1809-Madison    0.0000000    0.0000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">relFreq &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">list</span>(
    <span class="dt">document =</span> <span class="kw">rownames</span>(inaugDfm[, <span class="st">'american'</span>]),
    <span class="dt">frequency =</span> <span class="kw">unname</span>(<span class="kw">as.matrix</span>(relDfm[, <span class="st">'american'</span>]))
))

<span class="kw">ggplot</span>(relFreq) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>document,<span class="dt">y=</span>frequency)) +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">hjust=</span><span class="dv">1</span>))</code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#wordcloud">1. Wordcloud</a></li>
      <li>
<a href="#lexical-dispersion-plot">2. Lexical dispersion plot</a><ul class="nav nav-pills nav-stacked">
<li><a href="#modifying-lexical-dispersion-plots">Modifying lexical dispersion plots</a></li>
      </ul>
</li>
      <li><a href="#frequency-plots">3. Frequency plots</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Kenneth Benoit.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
